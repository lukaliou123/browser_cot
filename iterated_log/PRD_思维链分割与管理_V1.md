**产品需求文档 (PRD): 思维链分割与管理 V1**

**1. 引言 (Introduction)**

*   **1.1 项目背景:**
    思维链记录插件旨在帮助用户记录和可视化网页浏览过程中的思考路径。当前版本将所有浏览节点记录在单一思维链中，随着使用时间的增长，管理和回顾变得困难。本次迭代旨在引入思维链的分割与管理机制，提升用户体验和插件的实用性。
*   **1.2 本次迭代范围:**
    *   实现手动分割思维链功能。
    *   实现思维链的命名机制（自动默认命名与用户编辑命名）。
    *   实现按天自动分割思维链功能。
*   **1.3 名词解释:**
    *   **思维节点 (Thought Node):** 用户在浏览过程中记录的单个网页信息单元（URL、标题、时间戳、笔记等）。
    *   **思维链 (Thought Chain):** 由一系列有序思维节点组成的集合，代表用户一段连续的思考或研究过程。

**2. 用户故事 (User Stories)**

*   "作为一名用户，我希望能在我认为合适的时候手动结束当前的思维链并开启一个新的思维链，以便我可以根据自己的任务或思考阶段来组织记录。"
*   "作为一名用户，我希望每条思维链都有一个明确的名称，新创建的思维链能有一个合理的默认名称，并且我能够根据需要修改这个名称，方便我识别和管理不同的思维链。"
*   "作为一名用户，我希望插件能够每天自动将前一天的浏览记录归档为一条独立的思维链，并开始记录新的一天的内容，这样我的记录就能按天自动整理，便于回顾。"

**3. 功能详述 (Feature Specifications)**

*   **3.1 功能点一：手动分割思维链**
    *   **3.1.1 触发方式:**
        *   在插件的可视化界面或 popup 界面提供一个明确的"结束当前链并开始新链"的按钮/操作入口。
    *   **3.1.2 系统行为:**
        *   点击该按钮后，当前正在记录的思维链被标记为已完成/归档。
        *   系统立即创建一个新的、空的思维链，后续记录的节点将添加到这个新链中。
        *   新的思维链将按照 3.2.1 中的规则获得默认名称。
        *   在思维链选择列表中，用户可以看到旧链和新创建的链。
    *   **3.1.3 UI/UX 考虑:**
        *   按钮设计应清晰易懂，例如 "结束当前链" 或 "开始新链"。
        *   操作后应有明确的反馈，告知用户旧链已保存，新链已开始。

*   **3.2 功能点二：思维链命名**
    *   **3.2.1 默认命名规则:**
        *   当一个新的思维链被创建时（无论是手动分割还是自动分割），系统应为其生成一个默认名称。
        *   默认名称格式为："YYYY-MM-DD"。
        *   如果在同一天内创建了多条思维链，则在日期后追加序号，例如："YYYY-MM-DD (1)"、"YYYY-MM-DD (2)"，以此类推。序号从当天的第一条链开始（如果当天已存在由自动分割产生的链，则手动创建的链序号顺延）。
    *   **3.2.2 用户编辑命名功能:**
        *   用户应能够修改任何已存在的思维链的名称。
        *   在思维链列表或思维链详情界面提供编辑名称的入口（例如，点击名称旁边的小编辑图标，或在右键菜单中提供选项）。
        *   用户输入新名称后，系统保存更改。
    *   **3.1.3 UI/UX 考虑:**
        *   默认名称应直接显示。
        *   编辑名称的操作应便捷，例如直接点击名称变为可编辑状态，或提供清晰的编辑按钮。
        *   名称长度限制（如有）应有提示。

*   **3.3 功能点三：按天自动分割思维链**
    *   **3.3.1 触发条件:**
        *   每日服务器/本地时间的 00:00:00 （零点）。
    *   **3.3.2 系统行为:**
        *   当到达每日零点时，如果前一天存在活跃的、未被手动结束的思维链，系统自动将该思维链标记为完成/归档。该思维链的名称将是前一天的日期（例如，如果今天是 2025-05-14 00:00:00，则前一天的链被命名为 "2025-05-13"）。如果当天已存在同名链，则遵循 3.2.1 的重名规则。
        *   系统自动创建一个新的思维链，用于记录当天新产生的节点。新链的默认名称为当天的日期（例如 "2025-05-14"）。
        *   此功能应在插件后台静默执行，不打扰用户。
    *   **3.3.3 对现有数据的影响:**
        *   首次上线此功能时，对于已存在的非常长的、跨越多天的历史思维链，可以考虑：
            *   方案一：不进行追溯分割，仅对新数据生效。
            *   方案二：提供一次性工具或提示，让用户选择是否将历史数据按天分割（此方案较复杂，可延后）。**（本次迭代建议采用方案一，确保稳定性）**

**4. 非功能性需求 (Non-Functional Requirements)**

*   **4.1 性能:**
    *   思维链的分割和命名操作不应导致插件明显卡顿。
    *   后台自动分割不应显著增加浏览器资源消耗。
*   **4.2 易用性:**
    *   相关操作按钮和流程应符合用户直觉，易于发现和使用。
    *   命名和分割逻辑对用户透明。
*   **4.3 数据存储与兼容性:**
    *   思维链的分割信息和名称需要持久化存储在本地 (localStorage/IndexedDB)。
    *   确保数据结构的变更向前兼容或有平滑的迁移方案。

**5. 验收标准 (Acceptance Criteria)**

*   **5.1 手动分割思维链:**
    *   用户可以找到并成功使用"手动分割"按钮。
    *   点击后，原思维链被正确保存，并能从列表中选择。
    *   新的思维链被创建，并成为当前活动链，后续节点记录于此新链。
    *   新链获得正确的默认名称。
*   **5.2 思维链命名:**
    *   所有新创建的思维链（手动或自动）都有符合规则的默认名称。
    *   用户可以找到编辑思维链名称的入口。
    *   用户成功修改名称后，新名称被正确保存和显示。
*   **5.3 按天自动分割思维链:**
    *   跨越零点时，前一天的思维链被自动归档并以日期命名。
    *   新的一天的思维链被自动创建并以当天日期命名。
    *   连续多天的使用后，能看到按天分割的多条思维链。
    *   插件在后台自动执行此操作，用户无感知（除非查看思维链列表）。

**6. 未来展望 (Future Considerations)**

*   用户自定义自动分割时间。
*   基于"页面全部关闭"或"不活动时间"的自动分割策略。
*   为思维链添加标签或分类。
*   批量管理思维链（如删除、合并等）。 